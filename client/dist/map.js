var O=Object.defineProperty;var M=(l,r,t)=>r in l?O(l,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[r]=t;var I=(l,r,t)=>(M(l,typeof r!="symbol"?r+"":r,t),t);function A(l,r,t,a){function o(e){return e instanceof t?e:new t(function(n){n(e)})}return new(t||(t=Promise))(function(e,n){function d(i){try{s(a.next(i))}catch(c){n(c)}}function m(i){try{s(a.throw(i))}catch(c){n(c)}}function s(i){i.done?e(i.value):o(i.value).then(d,m)}s((a=a.apply(l,r||[])).next())})}function C(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var L=function l(r,t){if(r===t)return!0;if(r&&t&&typeof r=="object"&&typeof t=="object"){if(r.constructor!==t.constructor)return!1;var a,o,e;if(Array.isArray(r)){if(a=r.length,a!=t.length)return!1;for(o=a;o--!==0;)if(!l(r[o],t[o]))return!1;return!0}if(r.constructor===RegExp)return r.source===t.source&&r.flags===t.flags;if(r.valueOf!==Object.prototype.valueOf)return r.valueOf()===t.valueOf();if(r.toString!==Object.prototype.toString)return r.toString()===t.toString();if(e=Object.keys(r),a=e.length,a!==Object.keys(t).length)return!1;for(o=a;o--!==0;)if(!Object.prototype.hasOwnProperty.call(t,e[o]))return!1;for(o=a;o--!==0;){var n=e[o];if(!l(r[n],t[n]))return!1}return!0}return r!==r&&t!==t},W=C(L);const P="__googleMapsScriptId";var u;(function(l){l[l.INITIALIZED=0]="INITIALIZED",l[l.LOADING=1]="LOADING",l[l.SUCCESS=2]="SUCCESS",l[l.FAILURE=3]="FAILURE"})(u||(u={}));class g{constructor({apiKey:r,authReferrerPolicy:t,channel:a,client:o,id:e=P,language:n,libraries:d=[],mapIds:m,nonce:s,region:i,retries:c=3,url:p="https://maps.googleapis.com/maps/api/js",version:f}){if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=r,this.authReferrerPolicy=t,this.channel=a,this.client=o,this.id=e||P,this.language=n,this.libraries=d,this.mapIds=m,this.nonce=s,this.region=i,this.retries=c,this.url=p,this.version=f,g.instance){if(!W(this.options,g.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(g.instance.options)}`);return g.instance}g.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?u.FAILURE:this.done?u.SUCCESS:this.loading?u.LOADING:u.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let r=this.url;return r+="?callback=__googleMapsCallback&loading=async",this.apiKey&&(r+=`&key=${this.apiKey}`),this.channel&&(r+=`&channel=${this.channel}`),this.client&&(r+=`&client=${this.client}`),this.libraries.length>0&&(r+=`&libraries=${this.libraries.join(",")}`),this.language&&(r+=`&language=${this.language}`),this.region&&(r+=`&region=${this.region}`),this.version&&(r+=`&v=${this.version}`),this.mapIds&&(r+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(r+=`&auth_referrer_policy=${this.authReferrerPolicy}`),r}deleteScript(){const r=document.getElementById(this.id);r&&r.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((r,t)=>{this.loadCallback(a=>{a?t(a.error):r(window.google)})})}importLibrary(r){return this.execute(),google.maps.importLibrary(r)}loadCallback(r){this.callbacks.push(r),this.execute()}setScript(){var r,t;if(document.getElementById(this.id)){this.callback();return}const a={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(a).forEach(e=>!a[e]&&delete a[e]),!((t=(r=window==null?void 0:window.google)===null||r===void 0?void 0:r.maps)===null||t===void 0)&&t.importLibrary||(e=>{let n,d,m,s="The Google Maps JavaScript API",i="google",c="importLibrary",p="__ib__",f=document,h=window;h=h[i]||(h[i]={});const w=h.maps||(h.maps={}),b=new Set,k=new URLSearchParams,E=()=>n||(n=new Promise((y,_)=>A(this,void 0,void 0,function*(){var v;yield d=f.createElement("script"),d.id=this.id,k.set("libraries",[...b]+"");for(m in e)k.set(m.replace(/[A-Z]/g,S=>"_"+S[0].toLowerCase()),e[m]);k.set("callback",i+".maps."+p),d.src=this.url+"?"+k,w[p]=y,d.onerror=()=>n=_(Error(s+" could not load.")),d.nonce=this.nonce||((v=f.querySelector("script[nonce]"))===null||v===void 0?void 0:v.nonce)||"",f.head.append(d)})));w[c]?console.warn(s+" only loads once. Ignoring:",e):w[c]=(y,..._)=>b.add(y)&&E().then(()=>w[c](y,..._))})(a);const o=this.libraries.map(e=>this.importLibrary(e));o.length||o.push(this.importLibrary("core")),Promise.all(o).then(()=>this.callback(),e=>{const n=new ErrorEvent("error",{error:e});this.loadErrorCallback(n)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(r){if(this.errors.push(r),this.errors.length<=this.retries){const t=this.errors.length*Math.pow(2,this.errors.length);console.error(`Failed to load Google Maps script, retrying in ${t} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},t)}else this.onerrorEvent=r,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(r=>{r(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader.This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading||(this.loading=!0,this.setScript())}}}class F{constructor(){I(this,"loadedSegments",[]);this.preLoading(),window.addEventListener("resize",()=>this.preLoading("resize")),document.addEventListener("scroll",()=>this.preLoading("scroll")),document.addEventListener("click",()=>this.preLoading("scroll"))}preLoading(r){document.querySelectorAll("[data-map-segment]").forEach((t,a)=>{let o=this.loadedSegments.map(e=>e.id).indexOf(a);(r!==void 0||r===void 0&&t.getAttribute("data-lazy-loading")==="1")&&o<0&&this.isVisible(t)&&(this.loadedSegments.push({id:a,el:t}),this.initSegment(t))})}isVisible(r){const{top:t,bottom:a}=r.getBoundingClientRect(),o=window.innerHeight||document.documentElement.clientHeight;return(t>0||a>0)&&t<o}initSegment(r){const t=r.getAttribute("data-segment"),a=r.getAttribute("data-parameters");if(!r||!t)return;const o=JSON.parse(t);let e={center:{lat:o.Latitude,lng:o.Longitude},zoom:o.Zoom,backgroundColor:"#fff"};if(a)var n=JSON.parse(a);if(typeof n<"u"){const i=n.map_theme;var d=n.map_dynamic,m=n.map_inset_overview;delete n.map_theme,delete n.map_dynamic,delete n.map_height,delete n.map_inset_overview,n.mapTypeId==="-"&&delete n.mapTypeId,n.scrollwheel!==""&&(n.scrollwheel=JSON.parse(n.scrollwheel)),i.theme=="custom"&&i.styles?n.styles=JSON.parse(i.styles):o.Theme&&(n.styles=JSON.parse(o.Theme)),Object.keys(n).forEach((c,p)=>{n[c]===""&&delete n[c]}),e={...e,...n}}const s=new g({apiKey:o.Key,version:"weekly"});if(d.enabled){const i=document.getElementById("wrapper");if(d.preview){const c="https://maps.googleapis.com/maps/api/staticmap";i.style.backgroundImage=`url(${c}?center=${e.center.lat},${e.center.lng}&zoom=${e.zoom}&scale=2&size=${i.clientWidth}x${i.clientHeight}&key=${o.Key})`}i.addEventListener("click",()=>{i.remove(),s.load().then(()=>{const c=new google.maps.Map(r,e);this.mapOverviewInit(c,m,r,e),this.markerHandler(c,o,n,null),window.goldfinch&&window.goldfinch.map_callback&&window.goldfinch.map_callback(c,e,o,n)})})}else s.load().then(async()=>{let i=!1;o.Markers.length&&o.Markers.forEach((h,w)=>{h.Parameters&&(h.Parameters=JSON.parse(h.Parameters),h.Parameters&&h.Parameters.marker_type.markerType=="AdvancedMarker"&&!i&&(i=!0))});const{Map:c}=await google.maps.importLibrary("maps");if(n.mapId&&i)var{AdvancedMarkerElement:p}=await google.maps.importLibrary("marker");else var p=null;const f=new c(r,e);this.mapOverviewInit(f,m,r,e),this.markerHandler(f,o,n,p),window.goldfinch&&window.goldfinch.map_callback&&window.goldfinch.map_callback(f,e,o,n)})}markerHandler(r,t,a,o){t.Markers.length&&t.Markers.forEach((e,n)=>{let d;if(e.Parameters){const s={position:{lat:e.Latitude,lng:e.Longitude},map:r,title:e.Title};if(typeof e.Parameters!="object"&&(e.Parameters=JSON.parse(e.Parameters)),e.Parameters.marker_type.markerType=="AdvancedMarker"&&o){if(e.Parameters.marker_type.markerCustomHTML&&e.InfoWindow){const i=document.createElement("div");i.classList.add("custom-map-marker-wrapper"),i.innerHTML=e.InfoWindow,s.content=i}s.gmpDraggable=e.Parameters.marker_type.draggable,d=new o(s),window.goldfinch&&window.goldfinch.marker_callback&&window.goldfinch.marker_callback(d,s,e,r,t,a)}else{if(e.Parameters.marker_type.markerFont&&e.Parameters.marker_type.markerFontFamily&&e.Parameters.marker_type.markerFontCode)s.icon=" ",s.label={fontFamily:e.Parameters.marker_type.markerFontFamily,text:decodeURIComponent(JSON.parse(`"${e.Parameters.marker_type.markerFontCode.replace(/\"/g,'\\"')}"`))},e.Parameters.marker_type.markerFontColor&&(s.label.color=e.Parameters.marker_type.markerFontColor),e.Parameters.marker_type.markerFontSize&&(s.label.fontSize=e.Parameters.marker_type.markerFontSize);else if(e.Icon){const i={url:e.Icon};(e.Parameters.marker_type.markerScaleWidth||e.Parameters.marker_type.markerScaleHeight)&&(i.scaledSize=new google.maps.Size(e.Parameters.marker_type.markerScaleWidth,e.Parameters.marker_type.markerScaleHeight)),(e.Parameters.marker_type.markerAnchorX||e.Parameters.marker_type.markerAnchorY)&&(i.anchor=new google.maps.Point(e.Parameters.marker_type.markerAnchorX,e.Parameters.marker_type.markerAnchorY)),s.icon=i}e.Parameters&&e.Parameters.marker_type.markerAnimation&&(s.animation=google.maps.Animation[e.Parameters.marker_type.markerAnimation]),d=new google.maps.Marker(s),window.goldfinch&&window.goldfinch.marker_callback&&window.goldfinch.marker_callback(d,s,e,r,t,a)}if(e.Parameters&&e.Parameters.info_window.infoWindow&&e.InfoWindow){const i={content:e.InfoWindow,ariaLabel:e.Title};e.Parameters.info_window.infoWindowMaxWidth&&(i.maxWidth=e.Parameters.info_window.infoWindowMaxWidth),e.Parameters.info_window.infoWindowMinWidth&&(i.minWidth=e.Parameters.info_window.infoWindowMinWidth);const c=new google.maps.InfoWindow(i);d.addListener("click",()=>{c.open({anchor:d,map:r})}),window.goldfinch&&window.goldfinch.infoWindow_callback&&window.goldfinch.infoWindow_callback(c,i,d,r,e,t,a)}}})}mapOverviewInit(r,t,a,o){if(t){let c=function(p,f,h){return Math.min(Math.max(p,f),h)};var e=c;let s=a.getAttribute("data-map-segment");s=document.querySelector(`[data-map-overview="${s}"]`),s.style.display="block";const i=new google.maps.Map(s,{...o,gestureHandling:"none",fullscreenControl:!1,mapTypeControl:!1,rotateControl:!1,scaleControl:!1,streetViewControl:!1,zoomControl:!1});r.addListener("bounds_changed",()=>{i.setCenter(r.getCenter()),i.setZoom(c(r.getZoom()-5,3,10))})}}}document.addEventListener("DOMContentLoaded",()=>{new F});
